#include<bits/stdc++.h>
using namespace std;

class Solution {
  public:
    int solve(vector<int>&nums) {
        deque<pair<int,int>>dq;
        int i = 0, j;
        int ans = INT_MIN;

        for(j=0; j<nums.size(); j++) {
            while(!dq.empty() && dq.back().second <= nums[j]) {
                dq.pop_back();
            }
            dq.push_back({j, nums[j]});

            int maxElement = dq.front().second;
            if (maxElement > j-i+1) {
                ans = max(ans, j-i);

                while(maxElement > j-i+1) {
                    i++;
                    while(!dq.empty() && dq.front().first < i) {
                        dq.pop_front();
                    }

                    maxElement = dq.front().second;
                }
            }
        }

        int maxElement = dq.front().second;
        if (maxElement <= j-i) {
            ans = max(ans, j-i);
        }

        return ans;
    }
};

int main() {
    vector<int>nums = {1, 1, 1, 1, 2};

    Solution* solution = new Solution();
    cout<<solution->solve(nums);
}